<!DOCTYPE html>
<html>
<head>
  <title>Doctor Test Selector</title>
</head>
<body>
  <h3>Tests</h3>
  <label><input type="checkbox" id="CBC"> CBC</label><br>
  <label><input type="checkbox" id="RBS"> RBS</label><br>
  <label><input type="checkbox" id="RFT"> RFT</label><br>
  <label><input type="checkbox" id="Other"> Other</label>
  <input type="text" id="otherText" placeholder="Other test..." /><br><br>

  <button id="startBtn">ðŸŽ™ Start Listening</button>
  <p><b>Transcript:</b> <span id="transcript"></span></p>

  <script>
    // Simple dictionary mapping
    const synonyms = {
      "CBC": ["cbc", "complete blood count", "blood count"],
      "RBS": ["rbs", "sugar test", "random blood sugar", "sugar"],
      "RFT": ["rft", "renal function test", "kidney function"]
    };

    // Matching function
    function checkMatch(text) {
      let found = false;
      for (let key in synonyms) {
        for (let phrase of synonyms[key]) {
          if (text.toLowerCase().includes(phrase)) {
            document.getElementById(key).checked = true;
            found = true;
          }
        }
      }
      if (!found) {
        document.getElementById("Other").checked = true;
        document.getElementById("otherText").value = text;
      }
    }

    // Web Speech API setup
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    const recognition = new SpeechRecognition();
    recognition.lang = "en-US";
    recognition.continuous = true;
    recognition.interimResults = true;

    const transcriptEl = document.getElementById("transcript");
    document.getElementById("startBtn").onclick = () => recognition.start();

    recognition.onresult = (event) => {
      let text = "";
      for (let i = event.resultIndex; i < event.results.length; i++) {
        text += event.results[i][0].transcript;
      }
      transcriptEl.textContent = text;
      checkMatch(text);
    };
  </script>
</body>
</html>
